# Window Layout Strategy

## Screen Information
- Screen Resolution: {{screenWidth}}x{{screenHeight}} pixels
- Coordinate System: Top-left corner is (0,0)
- Available Work Area: Excludes system UI elements

## UI Component Boundaries (DO NOT OVERLAP)
{{uiComponents}}

## Layout Parameters
- Default window starting X: {{defaultX}}
- Default window starting Y: {{defaultY}}  
- Default window height: {{defaultHeight}}
- Gap between tiled windows: {{windowGap}}px
- Maximum usable width: {{maxUsableWidth}}px
- Minimum window width: {{minWindowWidth}}px

## Current Canvas State
{{canvasState}}

## Layout Rules

### CRITICAL: Always Check Existing Windows
Before positioning any new window, examine the current canvas state above. If windows already exist, you MUST create a tiled layout - never place windows on top of each other.

### Single Window (First Window Only)
When NO windows are currently open:
- Position: x={{defaultX}}, y={{defaultY}}
- Width: {{maxUsableWidth}}px  
- Height: {{defaultHeight}}px

### Multiple Windows (REQUIRED Tiling)
When windows are already open, you MUST tile them side by side:

**Step 1: Calculate Layout**
- Count existing windows: N_existing (from canvas state above)
- Total windows after adding new one: N_total = N_existing + 1
- Width per window: W = floor(({{maxUsableWidth}} - {{windowGap}} * (N_total - 1)) / N_total)
- Example: If 1 window exists and maxUsableWidth=1070, windowGap=10: W = floor((1070 - 10) / 2) = 530px

**Step 2: Resize ALL Existing Windows First**
- For each existing window, call resize_and_move_window with:
  - windowId: (existing window ID)
  - x: {{defaultX}} + (window_index * (W + {{windowGap}}))
  - y: {{defaultY}}
  - width: W
  - height: {{defaultHeight}}

**Step 3: Open New Window**
- Position new window at: x = {{defaultX}} + (N_existing * (W + {{windowGap}}))
- Use same width W and height {{defaultHeight}}

## Concrete Examples

### Example 1: First Window
Canvas State: "No windows currently open"
Action: Open window at ({{defaultX}}, {{defaultY}}) with width {{maxUsableWidth}}

### Example 2: Second Window (Tiling Required)
Canvas State: "Window window-3: https://google.com at (10, 50) size 1070x776"
Actions:
1. Resize window-3: x=10, y=50, width=530, height=776
2. Open new window: x=550, y=50, width=530, height=776

### Example 3: Third Window (Retiling Required)  
Canvas State: "2 windows at width 530 each"
Actions:
1. Resize window-3: x=10, y=50, width=343, height=776
2. Resize window-4: x=363, y=50, width=343, height=776  
3. Open new window: x=716, y=50, width=343, height=776

**REMEMBER**: Never place windows on top of each other. Always tile side by side when multiple windows exist. 